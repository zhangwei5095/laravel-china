<!DOCTYPE html>
<html><head>
	<meta charset="utf-8">
	<title>扩展包开发 - Laravel 中文文档
</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><script type="text/javascript" src="http://bam.nr-data.net/1/229d5871c8?a=12032708&pl=1432728428394&v=632.2b17625&to=ZFdUZUMCV0UHUURdWl0dY0NYTFBYAldIGkVbQg==&ap=34&be=116&fe=389&dc=222&f=%5B%5D&perf=%7B%22timing%22:%7B%22of%22:1432728428394,%22n%22:0,%22u%22:113,%22ue%22:113,%22dl%22:115,%22di%22:338,%22ds%22:338,%22de%22:430,%22dc%22:502,%22l%22:505,%22le%22:505,%22f%22:0,%22dn%22:0,%22dne%22:0,%22c%22:0,%22ce%22:0,%22rq%22:0,%22rp%22:109,%22rpe%22:320%7D,%22navigation%22:%7B%7D%7D&at=SBBXEwsYREs=&jsonp=NREUM.setToken"></script><script src="http://js-agent.newrelic.com/nr-632.min.js"></script><script src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o?o:n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({QJf3ax:[function(e,n){function t(e){function n(n,t,a){e&&e(n,t,a),a||(a={});for(var u=c(n),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,t);return s}function a(e,n){f[e]=c(e).concat(n)}function c(e){return f[e]||[]}function u(){return t(n)}var f={};return{on:a,emit:n,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=e("gos");n.exports=t()},{gos:"7eSDFh"}],ee:[function(e,n){n.exports=e("QJf3ax")},{}],3:[function(e,n){function t(e){return function(){r(e,[(new Date).getTime()].concat(i(arguments)))}}var r=e("handle"),o=e(1),i=e(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(e,n){window.NREUM[n]=t("api-"+n)}),n.exports=window.NREUM},{1:12,2:13,handle:"D5DuLP"}],"7eSDFh":[function(e,n){function t(e,n,t){if(r.call(e,n))return e[n];var o=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return e[n]=o,o}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],gos:[function(e,n){n.exports=e("7eSDFh")},{}],handle:[function(e,n){n.exports=e("D5DuLP")},{}],D5DuLP:[function(e,n){function t(e,n,t){return r.listeners(e).length?r.emit(e,n,t):(o[e]||(o[e]=[]),void o[e].push(n))}var r=e("ee").create(),o={};n.exports=t,t.ee=r,r.q=o},{ee:"QJf3ax"}],id:[function(e,n){n.exports=e("XL7HBI")},{}],XL7HBI:[function(e,n){function t(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:i(e,o,function(){return r++})}var r=1,o="nr@id",i=e("gos");n.exports=t},{gos:"7eSDFh"}],G9z0Bl:[function(e,n){function t(){var e=d.info=NREUM.info,n=f.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&n){c(p,function(n,t){n in e||(e[n]=t)});var t="https"===s.split(":")[0]||e.sslForHttp;d.proto=t?"https://":"http://",a("mark",["onload",i()]);var r=f.createElement("script");r.src=d.proto+e.agent,n.parentNode.insertBefore(r,n)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=e("handle"),c=e(1),u=(e(2),window),f=u.document,s=(""+location).split("?")[0],p={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-632.min.js"},d=n.exports={offset:i(),origin:s,features:{}};f.addEventListener?(f.addEventListener("DOMContentLoaded",o,!1),u.addEventListener("load",t,!1)):(f.attachEvent("onreadystatechange",r),u.attachEvent("onload",t)),a("mark",["firstbyte",i()])},{1:12,2:3,handle:"D5DuLP"}],loader:[function(e,n){n.exports=e("G9z0Bl")},{}],12:[function(e,n){function t(e,n){var t=[],o="",i=0;for(o in e)r.call(e,o)&&(t[i]=n(o,e[o]),i+=1);return t}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],13:[function(e,n){function t(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(0>o?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=t},{}]},{},["G9z0Bl"]);</script>
	<meta name="author" content="Laravel 中国">
	<meta name="description" content="扩展包开发,简介,建立一个扩展包,扩展包结构,服务提供者,缓载提供者,扩展包惯例,开发工作流程,扩展包路由,扩展包设定,扩展包视图,扩展包迁移,扩展包资源,发布扩展包,简介,扩展包是扩增 Laravel 的主要方式。扩展包可以是完成任何功能的数据，比方说处理时间的 Carbon 或是 BDD 测试框架如 Behat。,当然，目前有各式各样的扩展包。有些扩展包是独立运作 (stand-alone)...
">
	<meta name="keywords" content="laravel,laravel中国,laravel中文,laravel框架中文,laravel文档,laravel框架中国,laravel中文文档">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--[if lte IE 9]>
		<script src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
	<![endif]-->
	<link rel="stylesheet" href="../../assets/css/laravel.css">
</head>
<body class="docs language-php scotchified" style=""><div class="scotch-panel-wrapper" style="position: relative; overflow: hidden; width: 100%;"><div class="scotch-panel-canvas" style="position: relative; height: 100%; width: 100%; -webkit-transform: translate3d(0, 0, 0); -webkit-backface-visibility: hidden; -webkit-transition: all 300ms ease; transition: all 300ms ease;">

	<span class="overlay"></span>

	<nav class="main">
		<div class="container">
			<a href="../../index.html" class="brand">
				<img src="../../assets/img/laravel-logo.png" height="30">
				Laravel
			</a>

			<div class="responsive-sidebar-nav">
				<a href="packages.html#" class="toggle-slide menu-link btn">☰</a>
			</div>

							<div class="switcher">
	<div class="dropdown">
		<button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
			<!--<span class="faint">v</span> -->
			4.2
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							<li role="presentation">
					<a role="menuitem" tabindex="-1" href="../5.0/packages.html">5.0</a>
				</li>
							<li role="presentation">
					<a role="menuitem" tabindex="-1" href="packages.html">4.2</a>
				</li>
					</ul>
	</div>
</div>
			
			<ul class="main-nav">
				<li class="nav-docs"><a href="../5.0.html">文档</a></li>
<li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">Laracasts</a></li>
<li class="nav-docs"><a href="http://lumen.laravel-china.org">Lumen</a></li>
<li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a></li>
<li class="nav-api" style="display:none"><a href="http://laravel-china.org/api/5.0" target="_blank">API</a></li>
<li class="dropdown">
	<a href="https://phphub.org/" target="_blank">中文开发者社区</a>
</li>
<li class="dropdown">
	<a href="https://phphub.org/topics/453" target="_blank">Slack 聊天室</a>
</li>
<a href="https://github.com/laravel-china/docs" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
			</ul>
		</div>
	</nav>

	<nav id="slide-menu" class="slide-menu scotch-panel-left" role="navigation" style="top: 0px; left: -70%; width: 70%; height: 100%; position: absolute; z-index: 888888; overflow: hidden; -webkit-backface-visibility: hidden;">

	<div class="brand">
		<a href="../../index.html">
			<img src="../../assets/img/laravel-logo-white.png" height="50">
		</a>
	</div>

	<ul class="slide-main-nav">
		<li><a href="../../index.html">Home</a></li>
		<li class="nav-docs"><a href="../5.0.html">文档</a></li>
<li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">Laracasts</a></li>
<li class="nav-docs"><a href="http://lumen.laravel-china.org">Lumen</a></li>
<li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a></li>
<li class="nav-api" style="display:none"><a href="http://laravel-china.org/api/5.0" target="_blank">API</a></li>
<li class="dropdown">
	<a href="https://phphub.org/" target="_blank">中文开发者社区</a>
</li>
<li class="dropdown">
	<a href="https://phphub.org/topics/453" target="_blank">Slack 聊天室</a>
</li>
<a href="https://github.com/laravel-china/docs" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
	</ul>

	<div class="slide-docs-nav">
		<h2>文档</h2>
		<span>文档更新于: 2015-04-11</span>
		<ul>
<li>前言
<ul>
<li><a href="introduction.html">Laravel 介绍</a></li>
<li><a href="quick.html">快速入门</a></li>
<li><a href="releases.html">框架更新记录</a></li>
<li><a href="upgrade.html">升级指南</a></li>
</ul></li>
<li>快速上手
<ul>
<li><a href="installation.html">安装文档</a></li>
<li><a href="configuration.html">配置信息</a></li>
<li><a href="homestead.html">Homestead</a></li>
<li><a href="lifecycle.html">程序的生命周期</a></li>
<li><a href="routing.html">路由 Routing</a></li>
<li><a href="requests.html">处理用户请求和输入</a></li>
<li><a href="responses.html">视图和响应</a></li>
<li><a href="controllers.html">控制器</a></li>
<li><a href="errors.html">错误和日志</a></li>
</ul></li>
<li>更多 Laravel 知识
<ul>
<li><a href="security.html">身份认证功能</a></li>
<li><a href="billing.html">收费系统</a></li>
<li><a href="cache.html">缓存</a></li>
<li><a href="extending.html">扩展框架</a></li>
<li><a href="events.html">事件</a></li>
<li><a href="facades.html">Facades</a></li>
<li><a href="html.html">表单和HTML</a></li>
<li><a href="helpers.html">帮助函数</a></li>
<li><a href="ioc.html">IoC Container</a></li>
<li><a href="localization.html">本地化</a></li>
<li><a href="mail.html">邮件发送 Mail</a></li>
<li><a href="packages.html">扩展包开发</a></li>
<li><a href="pagination.html">分页功能</a></li>
<li><a href="queues.html">队列</a></li>
<li><a href="security.html">安全</a></li>
<li><a href="session.html">会话</a></li>
<li><a href="ssh.html">远程连接模块 SSH</a></li>
<li><a href="templates.html">模版引擎</a></li>
<li><a href="testing.html">单元测试</a></li>
<li><a href="validation.html">表单验证</a></li>
</ul></li>
<li>数据库 Database
<ul>
<li><a href="database.html">数据库简单使用</a></li>
<li><a href="queries.html">查询构造器</a></li>
<li><a href="eloquent.html">Eloquent ORM</a></li>
<li><a href="schema.html">表结构构造器</a></li>
<li><a href="migrations.html">Migrations &amp; Seeding</a></li>
<li><a href="redis.html">Redis</a></li>
</ul></li>
<li>命令行 Artisan CLI
<ul>
<li><a href="artisan.html">命令行 Artisan 介绍</a></li>
<li><a href="commands.html">开发 Artisan 命令</a></li>
</ul></li>
</ul>
	</div>

</nav>

<div class="docs-wrapper container">

	<section class="sidebar">
		<span>文档更新于: 2015-04-11</span>
		<ul>
<li>前言
<ul>
<li><a href="introduction.html">Laravel 介绍</a></li>
<li><a href="quick.html">快速入门</a></li>
<li><a href="releases.html">框架更新记录</a></li>
<li><a href="upgrade.html">升级指南</a></li>
</ul></li>
<li>快速上手
<ul>
<li><a href="installation.html">安装文档</a></li>
<li><a href="configuration.html">配置信息</a></li>
<li><a href="homestead.html">Homestead</a></li>
<li><a href="lifecycle.html">程序的生命周期</a></li>
<li><a href="routing.html">路由 Routing</a></li>
<li><a href="requests.html">处理用户请求和输入</a></li>
<li><a href="responses.html">视图和响应</a></li>
<li><a href="controllers.html">控制器</a></li>
<li><a href="errors.html">错误和日志</a></li>
</ul></li>
<li>更多 Laravel 知识
<ul>
<li><a href="security.html">身份认证功能</a></li>
<li><a href="billing.html">收费系统</a></li>
<li><a href="cache.html">缓存</a></li>
<li><a href="extending.html">扩展框架</a></li>
<li><a href="events.html">事件</a></li>
<li><a href="facades.html">Facades</a></li>
<li><a href="html.html">表单和HTML</a></li>
<li><a href="helpers.html">帮助函数</a></li>
<li><a href="ioc.html">IoC Container</a></li>
<li><a href="localization.html">本地化</a></li>
<li><a href="mail.html">邮件发送 Mail</a></li>
<li><a href="packages.html">扩展包开发</a></li>
<li><a href="pagination.html">分页功能</a></li>
<li><a href="queues.html">队列</a></li>
<li><a href="security.html">安全</a></li>
<li><a href="session.html">会话</a></li>
<li><a href="ssh.html">远程连接模块 SSH</a></li>
<li><a href="templates.html">模版引擎</a></li>
<li><a href="testing.html">单元测试</a></li>
<li><a href="validation.html">表单验证</a></li>
</ul></li>
<li>数据库 Database
<ul>
<li><a href="database.html">数据库简单使用</a></li>
<li><a href="queries.html">查询构造器</a></li>
<li><a href="eloquent.html">Eloquent ORM</a></li>
<li><a href="schema.html">表结构构造器</a></li>
<li><a href="migrations.html">Migrations &amp; Seeding</a></li>
<li><a href="redis.html">Redis</a></li>
</ul></li>
<li>命令行 Artisan CLI
<ul>
<li><a href="artisan.html">命令行 Artisan 介绍</a></li>
<li><a href="commands.html">开发 Artisan 命令</a></li>
</ul></li>
</ul>
	</section>

	<article>
		<h1>扩展包开发</h1>
<ul>
<li><a href="packages.html#introduction">简介</a></li>
<li><a href="packages.html#creating-a-package">建立一个扩展包</a></li>
<li><a href="packages.html#package-structure">扩展包结构</a></li>
<li><a href="packages.html#service-providers">服务提供者</a></li>
<li><a href="packages.html#deferred-providers">缓载提供者</a></li>
<li><a href="packages.html#package-conventions">扩展包惯例</a></li>
<li><a href="packages.html#development-workflow">开发工作流程</a></li>
<li><a href="packages.html#package-routing">扩展包路由</a></li>
<li><a href="packages.html#package-configuration">扩展包设定</a></li>
<li><a href="packages.html#package-views">扩展包视图</a></li>
<li><a href="packages.html#package-migrations">扩展包迁移</a></li>
<li><a href="packages.html#package-assets">扩展包资源</a></li>
<li><a href="packages.html#publishing-packages">发布扩展包</a></li>
</ul>
<p><a name="introduction"></a></p>
<h2><a href="packages.html#introduction">简介</a></h2>
<p>扩展包是扩增 Laravel 的主要方式。扩展包可以是完成任何功能的数据，比方说处理时间的 <a href="https://github.com/briannesbitt/Carbon">Carbon</a> 或是 BDD 测试框架如 <a href="https://github.com/Behat/Behat">Behat</a>。</p>
<p>当然，目前有各式各样的扩展包。有些扩展包是独立运作 (stand-alone) 的，意思是指他们并不相依任何框架，包括 Laravel 。刚提到的 Carbon 及 Behat 就是这种扩展包。要使用这种扩展包只需要在 <code class=" language-php">composer<span class="token punctuation">.</span>json</code> 文件里引入它们即可。</p>
<p>另一方面，有些扩展包特别指定要与 Laravel 整合。这种型式的扩展包在上一个版本的 Laravel 里称做 Bundle。这种扩展包可能有路由、控制器、视图、设定以及迁移，目标是增强 Laravel 本身的功能。由于没有特别需求要开发独立运作的扩展包，因此在这份指南里将主要以开发 Laravel 专属的扩展包为目标进行说明。</p>
<p>所有的 Laravel 扩展包都通过 <a href="http://packagist.org">Packagist</a> 及 <a href="http://getcomposer.org">Composer</a> 进行发布，因此学习如何使用这些美妙的 PHP 发布工具是一个必经的过程。</p>
<p><a name="creating-a-package"></a></p>
<h2><a href="packages.html#creating-a-package">建立一个扩展包</a></h2>
<p>建立一个新扩展包最简单的方式就是通过 <code class=" language-php">workbench</code> 这个 artisan 命令。首先，您需要先在 <code class=" language-php">app<span class="token operator">/</span>config<span class="token operator">/</span>workbench<span class="token punctuation">.</span>php</code> 里设定一些选项。在这个文件里，您会找到 <code class=" language-php">name</code> 及 <code class=" language-php">email</code> 这两个选项。这些选项里的值将会被用来产生扩展包里的 <code class=" language-php">composer<span class="token punctuation">.</span>json</code> 档。当您设定好这些前置工作后，就已经可以开始打造您的 workbench 扩展包了！</p>
<h4>启始一个 workbench artisan 命令</h4>
<pre class=" language-php"><code class=" language-php">php artisan workbench vendor<span class="token operator">/</span>package <span class="token operator">--</span>resources</code></pre>
<p>发行商 (vendor) 名称是为了识别不同作者发行相同名称的扩展包而设计的。比方说，我 (Taylor Otwell) 建立了一个新的扩展包名称为 "Zapper" ，而发行商的名称就是 <code class=" language-php">Taylor</code>。默认 workbench 命令会建立框架独立 (framework agnostic) 的扩展包结构。然后，<code class=" language-php">resources</code> 参数则会让 workbench 在产生扩展包结构时，额外针对 Laravel 产生特定的文件夹，包括 <code class=" language-php">migrations</code>、<code class=" language-php">views</code>、<code class=" language-php">config</code> 等。</p>
<p>当 <code class=" language-php">workbench</code> 命令被执行后，您的扩展包就可以在 <code class=" language-php">workbench</code> 文件夹内被获取。接着，您需要为您的扩展包<code class=" language-php">注册服务提供者 <span class="token punctuation">(</span>ServiceProvider<span class="token punctuation">)</span></code>。您可以通过在 <code class=" language-php">app<span class="token operator">/</span>config<span class="token operator">/</span>app<span class="token punctuation">.</span>php</code> 的 <code class=" language-php">providers</code> 数组里新增您扩展包的服务提供者名称进行注册，这个动作将会让 Laravel 启动时载入您的扩展包。服务提供者使用 <code class=" language-php"><span class="token punctuation">[</span>Package<span class="token punctuation">]</span>ServiceProvider</code> 这种命名惯例来为软件命名，以上述的例子来说，我们将会新增一行 <code class=" language-php">Taylor\<span class="token package">Zapper<span class="token punctuation">\</span>ZapperServiceProvider</span></code> 到 <code class=" language-php">providers</code> 数组里。</p>
<p>当提供者被注册后，您就已经完成扩展包开发的前置工作了！不过，建议您在深入开发工作前，先熟悉一下以下章节要接口的扩展包数据结构及开发工作流程。</p>
<blockquote>
<p><strong>注意：</strong> 假如您的服务提供者无法被载入，记得在您的应用程序根目录底下执行 <code class=" language-php">php artisan dump<span class="token operator">-</span>autoload</code> 命令。</p>
</blockquote>
<p><a name="package-structure"></a></p>
<h2><a href="packages.html#package-structure">扩展包结构</a></h2>
<p>当使用 <code class=" language-php">workbench</code> 命令后，您的扩展包将依照以下惯例进行初始化，这是为了让您的扩展包能与 Laravel 协同工作：</p>
<h4>基本的扩展包结构</h4>
<pre class=" language-php"><code class=" language-php"><span class="token operator">/</span>src
    <span class="token operator">/</span>Vendor
        <span class="token operator">/</span>Package
            PackageServiceProvider<span class="token punctuation">.</span>php
    <span class="token operator">/</span>config
    <span class="token operator">/</span>lang
    <span class="token operator">/</span>migrations
    <span class="token operator">/</span>views
<span class="token operator">/</span>tests
<span class="token operator">/</span><span class="token keyword">public</span></code></pre>
<p>让我们继续探索下去。<code class=" language-php">src<span class="token operator">/</span>Vendor<span class="token operator">/</span>Package</code> 文件夹是存放这个扩展包所有的相关类代码，包括 <code class=" language-php">ServiceProvider</code>。而 <code class=" language-php">config</code>、<code class=" language-php">lang</code>、<code class=" language-php">migrations</code>、<code class=" language-php">views</code> 文件夹，就如同您预想的一样，存放关于您的扩展包的相关资源，一个扩展包可以包含任何种类的资源，就像「一般」的应用程序一样。</p>
<p><a name="service-providers"></a></p>
<h2><a href="packages.html#service-providers">服务提供者</a></h2>
<p>服务提供者就是一个扩展包的启始类。默认来说，他包含两个方法：<code class=" language-php">boot</code> 和 <code class=" language-php">register</code>。通过这两个方法，您可以做任何您需要做的事，比方说：引入路由文件、注册 IoC 容器、注册事件或是任何其他您想要做的事。</p>
<p><code class=" language-php">register</code> 这个方法则是当服务提供者被注册时马上被调用，而 <code class=" language-php">boot</code> 命令则是仅当一个请求被路由时才会被执行。所以，假如您的服务提供者相依于其他已经注册的服务提供者，或是您想要重写由其他服务提供者所做的绑定，则您应该使用 <code class=" language-php">boot</code> 方法。</p>
<p>当使用 <code class=" language-php">workbench</code> 新建一个扩展包时， <code class=" language-php">boot</code> 命令就已经包括以下动作：</p>
<pre class=" language-php"><code class=" language-php"><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">package<span class="token punctuation">(</span></span><span class="token string">'vendor/package'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>这个方法让 Laravel 知道如何载入视图、设定及其他您的应用程序所需的资源。在大多数的情况下，跟随这个 workbench 的惯例即可，并不需要特别修改这一行。</p>
<p>在默认的情况下，当注册完扩展包后，其资源就可以通过 <code class=" language-php">vendor<span class="token operator">/</span>package</code> 取得。然后，您可以通过 package 方法的第二个参数来重写其动作，比方说：</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">// 将 custom-namespace 传给 package 方法
</span><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">package<span class="token punctuation">(</span></span><span class="token string">'vendor/package'</span><span class="token punctuation">,</span> <span class="token string">'custom-namespace'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">
// 则扩展包资源可通过 custom-namespace 取得
</span><span class="token variable">$view</span> <span class="token operator">=</span> <span class="token scope">View<span class="token punctuation">::</span></span><span class="token function">make<span class="token punctuation">(</span></span><span class="token string">'custom-namespace::foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>服务提供者类并没有「默认」的存放位置，您可以把它放在任何您喜欢的地方，或许可以将它们统一整理在 <code class=" language-php">Providers</code> 命名空间后，放到您的 <code class=" language-php">app</code> 文件夹里。只要 Composer <a href="http://getcomposer.org/doc/01-basic-usage.md#autoloading">知道如何载入它们的话</a>，您就可以把这些文件放在任何地方。</p>
<p>假如您更改了您扩展包资源存放的位置，可能是配置文件或是视图，那您就应该在 <code class=" language-php">package</code> 方法调用时，传入第三个参数来指定您的资源位置：</p>
<pre class=" language-php"><code class=" language-php"><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">package<span class="token punctuation">(</span></span><span class="token string">'vendor/package'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/path/to/resources'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><a name="deferred-providers"></a></p>
<h2><a href="packages.html#deferred-providers">缓载提供者</a></h2>
<p>假如您正在开发的服务提供者并没有注册任何形式的资源如配置文件或视图等，那您就可以考虑将您的服务提供者设定为「缓载」提供者。一个缓载提供者的特性就是只有需要它的功能时才载入，假如在当次的请求循环内不需要这个服务，则这个提供者就不会被载入。</p>
<p>要设定您的服务提供者采用缓载设定，只需要将 <code class=" language-php">defer</code> 属性设定为 <code class=" language-php"><span class="token boolean">true</span></code> 即可：</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">protected</span> <span class="token variable">$defer</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code></pre>
<p>接下来您应该从 <code class=" language-php">Illuminate\<span class="token package">Support<span class="token punctuation">\</span>ServiceProvider</span></code> 基础类重写 provides 方法，并回传一个数组包含所有您需要绑定到 IoC 容器的服务。举例来说，假如您的提供者注册 <code class=" language-php">package<span class="token punctuation">.</span>service</code> 和 <code class=" language-php">package<span class="token punctuation">.</span>another<span class="token operator">-</span>service</code> 给 IoC 容器，您的 <code class=" language-php">provides</code> 方法应该长得像这样：</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">provides<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'package.service'</span><span class="token punctuation">,</span> <span class="token string">'package.another-service'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p><a name="package-conventions"></a></p>
<h2><a href="packages.html#package-conventions">扩展包惯例</a></h2>
<p>当想要取用扩展包的资源如配置文件或是视图时，需要如下的方法使用双分号来取得：</p>
<h4>载入扩展包的视图</h4>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span class="token scope">View<span class="token punctuation">::</span></span><span class="token function">make<span class="token punctuation">(</span></span><span class="token string">'package::view.name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4>取得扩展包的配置文件</h4>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span class="token scope">Config<span class="token punctuation">::</span></span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">'package::group.option'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<p><strong>注意：</strong> 假如您的扩展包包括迁移，可以考虑在扩展包的迁移文件命名时加上您的扩展包名称，以避开迁移文件与其他扩展包在类命名时可能产生的冲突。</p>
</blockquote>
<p><a name="development-workflow"></a></p>
<h2><a href="packages.html#development-workflow">开发工作流程</a></h2>
<p>当您开发一个扩展包时，通过如同开发一个应用程序一样的脉络来进行往往是很有帮助的，这样能让您简单的观看及实验您的样板等。因此，安装一个新的 Laravel 框架，然后使用 <code class=" language-php">workbench</code> 命令来建立您的扩展包结构来开始你的工作流程。</p>
<p>当 <code class=" language-php">workbench</code> 命令建立好您的扩展包结构后，您可以直接在 <code class=" language-php">workbench<span class="token operator">/</span><span class="token punctuation">[</span>vendor<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">[</span>package<span class="token punctuation">]</span></code> 文件夹底下执行 <code class=" language-php">git init</code> 和 <code class=" language-php">git push</code> 进行开发过程的版本控制。这样可以让您很方便的在一个完整的应用程序脉络下开发您的扩展包，而不会受到 <code class=" language-php">composer update</code> 干扰而越陷越深。</p>
<p>既然您的扩展包在 <code class=" language-php">workbench</code> 文件夹内，您可能会很好奇 Composer 是怎么知道该如何载入您的扩展包文件？当 <code class=" language-php">workbench</code> 文件夹存在的话，Laravel 会很聪明的扫描底下的扩展包内容，并在应用程序启动时自动载入！</p>
<p>假如您需要重新产生您的扩展包自动载入文件，您可以使用 <code class=" language-php">php artisan dump<span class="token operator">-</span>autoload</code> 命令。这个命令会重新产生自动载入文件在您的根目录项目内。</p>
<h4>执行 artisan 自动载入命令</h4>
<pre class=" language-php"><code class=" language-php">php artisan dump<span class="token operator">-</span>autoload</code></pre>
<p><a name="package-routing"></a></p>
<h2><a href="packages.html#package-routing">扩展包路由</a></h2>
<p>在早先的 Laravel 里是使用 <code class=" language-php">handles</code> 的方式来指定哪些 URI 会由扩展包进行回应。但在 Laravel 4 里，一个扩展包可以对任何 URI 进行回应。在您的扩展包里载入路由文件，只需要在您的服务提供者的 <code class=" language-php">boot</code> 方法里 <code class=" language-php"><span class="token keyword">include</span></code> 即可。</p>
<h4>从服务提供者引入一个路由文件</h4>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">boot<span class="token punctuation">(</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">package<span class="token punctuation">(</span></span><span class="token string">'vendor/package'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">include</span> <span class="token constant">__DIR__</span><span class="token punctuation">.</span><span class="token string">'/../../routes.php'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<blockquote>
<p><strong>注意：</strong> 假如您的扩展包有使用控制器，您会需要确定您的 <code class=" language-php">composer<span class="token punctuation">.</span>json</code> 里的 auto-load 区块有正确的设定。</p>
</blockquote>
<p><a name="package-configuration"></a></p>
<h2><a href="packages.html#package-configuration">扩展包设定</a></h2>
<h4>取用扩展包配置文件</h4>
<p>有些扩展包需要配置文件，这些文件就如同应用程序配置文件一样的方式定义。而当您的服务提供者在注册资源时，通过 <code class=" language-php"><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">package</span></code> 方法后，即可通过「双冒号」语法取得其值：</p>
<pre class=" language-php"><code class=" language-php"><span class="token scope">Config<span class="token punctuation">::</span></span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">'package::file.option'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4>取得扩展包的单一配置文件</h4>
<p>假如您的扩展包仅包括一个单一配置文件，则您可以直接将文件名称命名为 <code class=" language-php">config<span class="token punctuation">.</span>php</code>。当您完成这个步骤后，您就可以直接取得值而不需要指定名：</p>
<pre class=" language-php"><code class=" language-php"><span class="token scope">Config<span class="token punctuation">::</span></span><span class="token function">get<span class="token punctuation">(</span></span><span class="token string">'package::option'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4>手动注册资源的命名空间</h4>
<p>有时候您或许会希望可以 <code class=" language-php"><span class="token this">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">package</span></code> 方法外，注册一个扩展包资源 (或许是视图等)。一般来说，这通常只有在资源不是放在惯例的位置时才需要这样做。您可以在使用 <code class=" language-php">View</code>、<code class=" language-php">Lang</code>、<code class=" language-php">Config</code> 等类时，通过调用 <code class=" language-php">addNamespace</code> 方法来手动注册资源：</p>
<pre class=" language-php"><code class=" language-php"><span class="token scope">View<span class="token punctuation">::</span></span><span class="token function">addNamespace<span class="token punctuation">(</span></span><span class="token string">'package'</span><span class="token punctuation">,</span> <span class="token constant">__DIR__</span><span class="token punctuation">.</span><span class="token string">'/path/to/views'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>当命名空间被注册后，您就可以通过「双冒号」来取得资源：</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword">return</span> <span class="token scope">View<span class="token punctuation">::</span></span><span class="token function">make<span class="token punctuation">(</span></span><span class="token string">'package::view.name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><code class=" language-php">addNamespace</code> 方法在 <code class=" language-php">View</code>、<code class=" language-php">Lang</code>、<code class=" language-php">Config</code> 等类上的实现是相同的。</p>
<h3>串接设定</h3>
<p>当其他的开发者安装了您的扩展包后，他们或许会希望可以重写部份的设定值。但假如他们直接修改您的扩展包代码，则当他们下次执行 composer update 时，这些设定值就又会被重写回来。取而代之，应该使用 <code class=" language-php">config<span class="token punctuation">:</span>publish</code> 命令来发布配置文件：</p>
<pre class=" language-php"><code class=" language-php">php artisan config<span class="token punctuation">:</span>publish vendor<span class="token operator">/</span>package</code></pre>
<p>当这个命令被执行后，所有您的扩展包的配置文件都会被复制一份到 <code class=" language-php">app<span class="token operator">/</span>config<span class="token operator">/</span>packages<span class="token operator">/</span>vendor<span class="token operator">/</span>package</code> 底下，这样配置文件的内容就可以安全的被其他开发人员修改！</p>
<blockquote>
<p><strong>注意：</strong> 开发者也有可能会建立环境配置文件，这些配置文件则会被放在 <code class=" language-php">app<span class="token operator">/</span>config<span class="token operator">/</span>package<span class="token operator">/</span>vendor<span class="token operator">/</span>package<span class="token operator">/</span>environment</code> 底下。</p>
</blockquote>
<p><a name="package-views"></a></p>
<h2><a href="packages.html#package-views">扩展包视图</a></h2>
<p>假如您在应用程序里使用扩展包，您偶尔会希望可以自定义扩展包的视图。您可以非常容易的通过 <code class=" language-php">view<span class="token punctuation">:</span>publish</code> 命令将扩展包的视图输出到您的 <code class=" language-php">app<span class="token operator">/</span>views</code> 文件夹底下。</p>
<pre class=" language-php"><code class=" language-php">php artisan view<span class="token punctuation">:</span>publish vendor<span class="token operator">/</span>package</code></pre>
<p>这个命令会将扩展包的视图移到 <code class=" language-php">app<span class="token operator">/</span>views<span class="token operator">/</span>packages</code> 文件夹内。假如这个文件夹还不存在的话，这个命令会自动帮您建立。当这些视图被输出后，您就可以依您所意进行调整。而当应用程序执行时，这些被调整过的视图就会被优先使用于扩展包的默认值。</p>
<p><a name="package-migrations"></a></p>
<h2><a href="packages.html#package-migrations">扩展包迁移</a></h2>
<h4>为扩展包进行迁移文件</h4>
<p>您的扩展包可以非常容易的建立与执行迁移。当您想要为您的扩展包新增迁移文件时，只需要在命令后面加上 <code class=" language-php"><span class="token operator">--</span>bench</code> 参数：</p>
<pre class=" language-php"><code class=" language-php">php artisan migrate<span class="token punctuation">:</span>make create_users_table <span class="token operator">--</span>bench<span class="token operator">=</span><span class="token string">"vendor/package"</span></code></pre>
<h4>为扩展包执行迁移</h4>
<pre class=" language-php"><code class=" language-php">php artisan migrate <span class="token operator">--</span>bench<span class="token operator">=</span><span class="token string">"vendor/package"</span></code></pre>
<h4>为已安装的扩展包执行迁移</h4>
<p>为通过 Composer 安装的扩展包 (安装于 <code class=" language-php">vendor</code> 文件夹底下) 执行迁移，仅需加上 <code class=" language-php"><span class="token operator">--</span>package</code> 参数：</p>
<pre class=" language-php"><code class=" language-php">php artisan migrate <span class="token operator">--</span>package<span class="token operator">=</span><span class="token string">"vendor/package"</span></code></pre>
<p><a name="package-assets"></a></p>
<h2><a href="packages.html#package-assets">扩展包资源 Assets</a></h2>
<h4>把扩展包资源移到 public</h4>
<p>有些扩展包会带有诸多资源如 Javascript、CSS 和图片。然而，我们没有办法取用这些在 <code class=" language-php">vendor</code> 或 <code class=" language-php">workbench</code> 文件夹里的资源，所以我们需要一个把它们移到 <code class=" language-php"><span class="token keyword">public</span></code> 文件夹的方法。而 <code class=" language-php">asset<span class="token punctuation">:</span>publish</code> 这个命令就是为了这个目的而存在：</p>
<pre class=" language-php"><code class=" language-php">php artisan asset<span class="token punctuation">:</span>publish

php artisan asset<span class="token punctuation">:</span>publish vendor<span class="token operator">/</span>package</code></pre>
<p>假如扩展包仍在 <code class=" language-php">workbench</code> 阶段，记得加上 <code class=" language-php"><span class="token operator">--</span>bench</code> 参数</p>
<pre class=" language-php"><code class=" language-php">php artisan asset<span class="token punctuation">:</span>publish <span class="token operator">--</span>bench<span class="token operator">=</span><span class="token string">"vendor/package"</span></code></pre>
<p>这个命令将会把资源依照供应商及扩展包名称移至 <code class=" language-php"><span class="token keyword">public</span><span class="token operator">/</span>packages</code> 底下。因此，一个叫 <code class=" language-php">userscape<span class="token operator">/</span>kudos</code> 的扩展包资产就会被移到 <code class=" language-php"><span class="token keyword">public</span><span class="token operator">/</span>packages<span class="token operator">/</span>userscape<span class="token operator">/</span>kudos</code>。使用这个惯例可以让您安全地在您的扩展包视图中引入资源。</p>
<p><a name="publishing-packages"></a></p>
<h2><a href="packages.html#publishing-packages">发布扩展包</a></h2>
<p>当您的扩展包已经准备好可以发布时，您应该先将您的扩展包送至 <a href="http://packagist.org">Packagist</a> 。假如这个扩展包是专属于 Laravel 的话，您可以考虑在您的 <code class=" language-php">composer<span class="token punctuation">.</span>json</code> 档里加上 <code class=" language-php">laravel</code> 的标签。</p>
<p>同时，标记您的版本对其他开发者来说也是很有用的。当开发者安装您的扩展包时，可以设定其偏好的版本 (stable, dev)。假如您的扩展包还没有稳定的版本，您可以考虑使用 <code class=" language-php">branch<span class="token operator">-</span>alias</code>。</p>
<p>当您的扩展包发布后，仍可以继续通过原本的 <code class=" language-php">workbench</code> 应用程序脉络持续开发。这是当一个扩展包发布后，持续更新的最好方法。</p>
<p>有些组织选择自行建立他们内部使用的私有扩展包储存库给他们的开发者。假如您对这种作法也有兴趣，欢迎浏览由 Composer 释出的 <a href="http://github.com/composer/satis">Satis</a> 项目文件。</p>
	</article>
</div>

	<footer class="main">
		<ul>
			<li class="nav-docs"><a href="../5.0.html">文档</a></li>
<li class="nav-laracasts"><a href="https://laracasts.com" target="_blank">Laracasts</a></li>
<li class="nav-docs"><a href="http://lumen.laravel-china.org">Lumen</a></li>
<li class="nav-forge"><a href="https://forge.laravel.com" target="_blank">Forge</a></li>
<li class="nav-api" style="display:none"><a href="http://laravel-china.org/api/5.0" target="_blank">API</a></li>
<li class="dropdown">
	<a href="https://phphub.org/" target="_blank">中文开发者社区</a>
</li>
<li class="dropdown">
	<a href="https://phphub.org/topics/453" target="_blank">Slack 聊天室</a>
</li>
<a href="https://github.com/laravel-china/docs" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
		</ul>
		<p>Laravel is a trademark of Taylor Otwell. Copyright © Taylor Otwell.</p>
		<p class="less-significant"><a href="http://jackmcdade.com">Design by Jack McDade</a></p>
	</footer>
	<script src="../../assets/js/laravel.js"></script>
	<script src="../../assets/js/viewport-units-buggyfill.js"></script>
	<script>window.viewportUnitsBuggyfill.init();</script>
    <script>
        var _gaq=[['_setAccount','UA-53903425-2'],['_trackPageview']];
        (function(d,t){
            var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)
        }(document,'script'));
    </script>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"229d5871c8","applicationID":"12032708","transactionName":"ZFdUZUMCV0UHUURdWl0dY0NYTFBYAldIGkVbQg==","queueTime":0,"applicationTime":34,"ttGuid":"","agentToken":"","atts":"SBBXEwsYREs=","errorBeacon":"bam.nr-data.net","agent":"js-agent.newrelic.com\/nr-632.min.js"}</script><p style="margin: 0px;"></p>

</div></div><a id="scrollUp" href="packages.html#top" style="display: none; position: fixed; z-index: 2147483647;">返回顶部</a></body></html>